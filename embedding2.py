from openai import OpenAI
import os
import pickle

# Upstage Solar API 클라이언트 설정
client = OpenAI(
    api_key="up_MixgDl0HXpwJm7THloh2OjKIH1T8m",  # 환경변수에서 가져오기
    base_url="https://api.upstage.ai/v1/solar"
)

print("🔄 Upstage Solar API 클라이언트 설정 완료")
print(f"   API Key: {os.getenv('up_MixgDl0HXpwJm7THloh2OjKIH1T8m', 'NOT SET')[:20]}...")


# 서안개발 및 금하빌딩 정보 청크
article_chunks = [
    # ============================================================
    # 서안개발 정보
    # ============================================================
    
    # CHUNK 1: 서안개발 기본 정보 + 연혁
    """서안개발주식회사 기본 정보:

회사명: 서안개발주식회사 (SUHAN DEVELOPMENT CO., LTD)
설립일: 1991년 7월 1일
본점 주소: 서울특별시 강남구 학동로 401 (청담동 41-2, 금하빌딩)
주요 사업: 부동산 임대 및 관리 (부동산임대, 시설관리, 컨설팅)

연혁:
- 1991년: 서안개발주식회사 설립
- 2021년: 창립 30주년 달성
- 2025년: 현재 안정적 부동산 자산 운영 중""",
    
    # CHUNK 2: 서안개발 핵심 역량
    """서안개발주식회사의 핵심 역량:

30년 이상의 노하우로 강남권 중심의 부동산 임대 및 관리 사업을 안정적으로 운영하고 있습니다.
자가 보유 부동산인 금하빌딩을 기반으로 안정적인 수익을 창출하고 있습니다.
입주사와의 견고한 관계를 바탕으로 지속 가능한 성장을 추구하고 있습니다.
"공간을 넘어 자산가치를 설계하는 기업"이라는 비전을 실현하고 있습니다.""",
    
    # ============================================================
    # 금하빌딩 기본 정보
    # ============================================================
    
    # CHUNK 3: 금하빌딩 기본 정보
    """청담동 금하빌딩 기본 정보:

건물명: 금하빌딩
소재지: 서울특별시 강남구 학동로 401 (청담동 41-2)

건축 정보:
- 대지면적: 2,716.2㎡ (821.65평)
- 연면적: 36,392.99㎡ (11,008.83평)
- 용도지역(토지): 일반상업지역
- 건축물 시설 주용도 구분: 일반업무시설, 제2종근린생활시설
- 층수: 지상 18층, 지하 7층
- 엘리베이터: 총6대(승객용 4대, 비상용 2대)
- 냉난방 : 중앙
- 준공일자 : 1995-10-09
- 주차: 자주식 총 222대 수용 가능
- 주차관계: 무료는 임대 면적 50평당 1대, 추가 주차시 1대당 월 200,000원(VAT별도)""",
    
    # ============================================================
    # 금하빌딩 교통 및 위치
    # ============================================================
    
    # CHUNK 4: 금하빌딩 위치 및 교통
    """청담동 금하빌딩 위치 및 교통 정보:

주소: 서울특별시 강남구 학동로 401 (청담동 41-2, 금하빌딩)

지하철 접근성:
- 강남구청역 (수인분당선, 7호선) 4번 출구 도보 약 1분 거리
- 매우 편리한 대중교통 접근성

버스 :
청담동래미안아파트 1분

차량 진출입 : 
지상/지하추자장 진입 용이함(램프식 지하주차장)

주변 환경:
- 강남구청 인접 (70.5m 거리)
- 강남 핵심 업무지구 위치
- 노선 접근성: 7호선, 수인분당선 이용 가능

주차 시설:
- 지하 2층~7층 주차장
- 총 자주식 222대 주차 가능
- 24시간 이용 가능""",
    
    # ============================================================
    # 금하빌딩 임대 정보
    # ============================================================
    
    # CHUNK 5: 금하빌딩 임대 조건
    """청담동 금하빌딩 임대 조건:

임대 정보 CHUNK ① — 11층 (일부)
금하빌딩 11층은 효율적인 공간 활용이 가능한 사무실을 제공합니다. 
넓은 전용 면적(143.28평)을 통해 다양한 레이아웃 구성이 가능하며, 쾌적한 업무 환경을 조성 할 수 있습니다.

해당층: 11층 (일부)
-임대면적: 286.56평
-전용면적: 143.28평
-보증금: 3억 5,000만원
-평당 임대보증금: 1,221,380원
-임대료: 2,579만 400원
-평당 임대료: 9만/평
-관리비: 1,289만 5,200원
-평당 관리비: 45,000원
-NOC (평당 비용): 270,000원
-입주시기: 2026년 1월 (2025년 12월 말 종료 예정)
-명시된 조건 사항은 협의 가능""",

    """
    임대 정보 CHUNK ② — 17층
금하빌딩 17층은 전용 테라스가 있어 뛰어난 조망권을 자랑하는 프리미엄 사무실입니다. 
전용면적137평으로, 2025년 12월중순부터 내부공사 착수가 가능합니다.
해당층: 17층
-임대면적: 274평
-전용면적: 137평
-보증금: 2억 7,400만원
-평당 임대보증금: 1,000만원
-임대료: 2,466만원
-평당 임대료: 9만/평
-관리비: 1,233만원
-평당 관리비: 45,000원
-NOC (평당 비용): 270,000원
-입주시기: 2026년 1월(2025년 12월 중순 내부공사 착수 가능)
-명시된 조건 사항은 협의 가능""",

"""
주차 조건:
- 기본 무료 주차: 입대면적 50평당 1대 무상
- 추가 유료 주차: 대당 200,000원/월

참고사항:
- 2025년 10월 기준 정보
- 실제 임대 조건은 층별, 면적별로 상이할 수 있음
- 상세 조건은 문의 필요
- 명시된 조건 사항은 협의 가능""",
    
    # ============================================================
    # 금하빌딩 층별 현황
    # ============================================================
    
    # CHUNK 6: 금하빌딩 층별 임대 현황
    """청담동 금하빌딩 층별 임대 현황 (2025년 10월 기준):

청담동 금하빌딩 층별 임대 현황 (2025년 10월 기준)

17F : 공실
16F : 콘메드코리아(유)
15F : 신원종합개발(주)
14F : 한국마즈(유)
13F : 니프코코리아
12F : 한국바이린
11F : 공실 / DMC미디어
10F : 로얄캐닌
09F : (주)인스코비
08F : (주)엔텔스
07F : (주)엔텔스
06F : (주)대농
05F : DMC미디어
04F : 법무법인 정률
03F : 더스킨팩토리
02F : 한국투자증권, 골든블루, KB손해보험
01F : 우리은행, 풀바셋
B1F : 식당, 카페, 법무법인 창, 서안개발
B2F~B7F : 주차장, 기계실

공실 층:
- 17층: 공실, 즉시 입주 가능(2025년 12월 말 종료 예정)
- 11층(일부): 공실, 즉시 입주 가능(2025년 12월 중순 내부공사 착수 가능)""",
    
    # ============================================================
    # 금하빌딩 문의 정보
    # ============================================================
    
    # CHUNK 7: 금하빌딩 임대 문의
    """청담동 금하빌딩 임대 문의 안내:

청담동 금하빌딩 사무실 임대에 대한 공급 안내 및 관련 문의 사항을 전문 담당자가 친절하게 안내해드립니다.
전문 컨설턴트가 안내드립니다.

상담 대표 번호: 02-3443-0724

담당자 연락처:
1) 담당자: 정명덕 팀장
   - 전화: 02-3443-0724


문의 방법:
- 전화 상담 
- 방문 상담

문의 시 안내 사항:
- 희망 입주 시기
- 필요 면적 (평수)
- 예산 범위
- 주차 대수 필요 여부
- 기타 요구사항""",
    
    """REXA AI 부동산 챗봇 : REXA는 서안개발 컨설팅팀에서 운영하고 있는 서비스로, 사용자 친과적인 인터페이스를 통해 부동산 관련 정보를 실시간으로 제공하고, 맞춤형 컨설팅을 지원하여 고객의 의사결정을 돕습니다. 
    """,
    # ============================================================
    # 금하빌딩 특징 및 장점
    # ============================================================
    
    # CHUNK 8: 금하빌딩 특징 및 장점
"""청담동 금하빌딩의 특징 및 장점:

입지 특징:
- 강남구청역 도보 1분 초역세권
- 강남 핵심 업무지구 위치
- 7호선, 수인분당선 더블역세권
- 강남구청 인접으로 행정 업무 편리

건물 특징:
- 지상 17층 규모의 중대형 오피스
- 넉넉한 자주식 주차 공간 (222대)
- 엘리베이터 및 편의시설 완비

관리 특징:
- 서안개발 직접 운영 관리
- 30년 이상의 건물 관리 노하우
- 안정적인 임대 운영
- 입주사 맞춤 서비스 제공""",
    # ============================================================
    # 홍대 마포 서교동 회장님 건물
    # ============================================================
    
    # CHUNK 9: 홍대 마포 서교동 회장님 건물
    """서교동 328-26 건물 기본 정보:
- 건물 개요:
- 건물명: 서교동 328-26 (상가건물)
- 소재지: 서울특별시 마포구 서교동 328-26""",

    """서교동 328-26 건물 건축 정보:
- 대지면적: 248.9㎡ (약 75.29평)
- 연면적: 415.68㎡ (약 125.74평)
- 건물용도: 제2종 근린생활시설
- 층수: 지상 3층, 지하 1층
- 용적률: 98%
- 주차: 0대 """,

    """서교동 328-26 위치 및 교통 정보:
- 주소: 서울특별시 마포구 서교동 328-26

- 지하철 접근성:
- 홍대입구역 (경의중앙선, 2호선, 공항철도) 6번 출구 도보 약 3분 거리
- 트리플 역세권으로 매우 편리한 대중교통 접근성

- 버스 정류장:
- R2(홍대걷고싶은거리) 정류장 도보 4분
- 산울림소극장 정류장 도보 4분

- 도로 접근성:
- R2 회전교차로에서 바로 진입 가능한 이면도로 위치
- 차량 진출입 용이

- 주변 환경:
- 홍대 핵심 상권 위치
- 홍대걷고싶은거리 인접
- 유동인구가 많은 번화가 입지""", 

    """서교동 328-26 매매 조건:
- 매매가격:
- 매매가: 80억 원
- 대지 평당가: 10,625만 원/평
- 연면적 평당가: 6,362만 원/평

- 수익성 분석:
- 월 임대수익: 1,596만 원
- 연 임대수익: 19,152만 원
- 연 수익률: 약 2.43%

- 참고사항:
- 2025년 11월 기준 정보
- 홍대 핵심상권 안정적 수익형 부동산
- 실제 매매 조건은 협의 가능
- 상세 조건은 문의 필요
- 명시된 조건 사항은 협의 가능""",

"""서교동 328-26 층별 임대 현황 (2025년 11월 기준):
- 1층 땡클빵글(101호), 김덕후의 곱창조(102호),타레퀸(103호)
- 2층 더담다이닝(201호), 애쉬앤블룸(202호)
- 3층 애쉬앤블룸(301·302호)""",


"""서교동 328-26 층별 임대 현황 (2025년 11월 기준):
- 1층 땡클빵글(101호): 101호, 보증금 2,000만 원, 월세 315만 원
- 1층 김덕후의 곱창조: 102호, 보증금 1,000만 원, 월세 205만 원
- 1층 타레퀸: 103호, 보증금 3,000만 원, 월세 340만 원
- 2층 더담다이닝: 201호, 보증금 3,000만 원, 월세 290만 원
- 2층 애쉬앤블룸: 202호, 보증금 1,000만 원, 월세 165만 원
- 3층 애쉬앤블룸: 301·302호, 보증금 3,000만 원, 월세 280만 원


- 서교동 328-26 임대 현황 요약:
- 총 보증금: 약 1억 3,000만 원
- 총 월세 수익: 1,596만 원
- 전체 6개 점포 임대 중 
- 주요 업종: 음식점, 카페, 제과점""",


"""서교동 328-26 매매 문의 안내:
- 문의 내용:
- 서교동 328-26 건물 매매에 대한 상세 안내 및 관련 문의 사항을 전문 담당자가 친절하게 안내해드립니다. 전문 컨설턴트가 안내드립니다.

- 상담 대표 번호: 02-3443-0724

- 담당자 연락처:
- 담당자: 정명덕 팀장
- 소속: 서안개발 컨설팅팀 (SUHAN DEVELOPMENT Co., Ltd.)
- 주소: 서울시 강남구 학동로 401 (청담동) 금하빌딩
- 전화: 02-3443-0724

- 문의 방법:
- 전화 상담
- 방문 상담 가능

- 문의 시 안내 사항:
- 매수 예산 범위
- 투자 목적 (직접 운영 / 임대수익)
- 자금 계획
- 기타 요구사항""",

"""서교동 328-26의 특징 및 장점:
- 입지 특징:
- 홍대입구역 도보 3분 초역세권
- 홍대 핵심 상권 위치
- 경의중앙선, 2호선, 공항철도 트리플 역세권
- 홍대걷고싶은거리 인접으로 높은 유동인구

- 건물 특징:
- 지상 3층 규모의 근린생활시설
- R2 회전교차로 인근 접근성 우수
- 6개 점포 전체 임대 중 (안정적 수익)
- 이면도로 위치로 조용한 환경

- 투자 특징:
- 홍대 핵심상권 안정적 수익형 자산
- 연 수익률 2.43%의 꾸준한 임대수익
- 전체 공실 없는 안정적 운영
- 프랜차이즈 및 개성있는 점포 입점""",

    # ============================================================
    # 서울특별시 영등포구 도림로 268-2 (신길동 342-337)
    # ============================================================

"""더베스트 신길동 매물 요약:
    매물유형: 매매
    주소: 서울특별시 영등포구 도림로 268-2 (신길동 342-337)
    매매가: 19억 원
    대지면적: 128㎡ (약 38.72평)
    연면적: 299.99㎡ (약 90.75평)
    건물용도: 제2종근린생활시설
    층수: 지하 1층, 지상 4층(옥탑 포함 5층)
    주차: 없음(현황 1대)
    현재상태: 소싱중
    (비공개) 매각진행중""",

    """영등포구 도림로 268-2 임대 현황:
    전체 임대보증금 6,500만 원, 월세 550만 원
    임대 세부 내역:
    - 옥탑: 공실 (보증금 500만 원 / 월세 30만 원 / 관리비 5만 원)
    - 2~4층: 더베스트학원 (보증금 3,000만 원 / 월세 260만 원 / 관리비 15만 원)
    - 1층: 문구야놀자 (보증금 2,000만 원 / 월세 180만 원 / 관리비 5만 원)
    - 지하: 공실 (보증금 1,000만 원 / 월세 80만 원 / 관리비 5만 원)
    현재 일부 공실 있으나, 2~4층 학원 임대로 안정적 수익 중.
    2025년 11월 기준 정보""",

    """영등포구 도림로 268-2 입지 및 교통:
    위치 설명:
    서울대영초등학교 정문 앞, 신길뉴타운 인접
    7호선 신풍역 도보 5~6분 거리, 2026년 신안산선 개통 시 도보 3분 거리(250m 예상)
    버스정류장: 대영초중고역 도보 1분(약 50m)
    도로 접근성: 6m × 4m 코너 도로, 30m 주도로 한 칸 이면 위치
    차량 진출입 용이, 상권 접근성 우수
    주거 및 학원 수요 밀집 지역으로 투자 안정성 높음""",

    """건물 특이사항:
    최근 전층 리모델링 완료, 1~4층 내부 및 옥상 정비 완료
    내부 화장실 총 5개, 학원 및 근린상가로 활용 적합
    남향 코너 건물로 일조량 및 가시성 우수
    학원, 병원, 근린상가 등 복합운영 가능""",

    """담당자 정보:
    담당자: 정명덕 팀장 (서안개발 컨설팅팀)
    연락처: 02-3443-0724
    이메일: Ryan@suhan.co.kr""",

]


print(f"\n📝 총 {len(article_chunks)}개의 청크 준비 완료")
print("\n🔄 Solar Embedding API를 사용하여 임베딩 생성 중...")

# Solar Embedding API를 사용하여 각 청크에 대한 임베딩 생성
chunk_embeddings = []

for i, chunk in enumerate(article_chunks, 1):
    try:
        print(f"   처리 중: Chunk {i}/{len(article_chunks)}...", end=" ")
        
        embedding = client.embeddings.create(
            input=chunk, 
            model="solar-embedding-1-large-passage"  # Solar 임베딩 모델 (문서용, 4096 차원)
        ).data[0].embedding
        
        chunk_embeddings.append(embedding)
        print(f"✅ 완료 (차원: {len(embedding)})")
        
    except Exception as e:
        print(f"❌ 실패")
        print(f"   에러: {e}")
        raise

# 임베딩 데이터를 pickle 파일로 저장
print("\n💾 embeddings.pkl 파일로 저장 중...")

with open("embeddings.pkl", "wb") as f:
    pickle.dump({
        "chunks": article_chunks, 
        "embeddings": chunk_embeddings
    }, f)

print("\n" + "="*70)
print("✅ 성공적으로 완료!")
print("="*70)
print(f"📊 청크 개수: {len(article_chunks)}")
print(f"📊 임베딩 차원: {len(chunk_embeddings[0])}")
print(f"📊 파일 크기: {os.path.getsize('embeddings.pkl') / 1024:.2f} KB")
print("="*70)
print("\n💡 다음 단계:")
print("   1. embeddings.pkl 파일을 프로젝트 루트에 배치")
print("   2. main.py와 함께 Git에 커밋")
print("   3. Render에 배포")
print("\n🔑 필요한 환경변수:")
print("   - UPSTAGE_API_KEY (이미 사용 중)")
print("   - OPENAI_API_KEY는 필요 없음! (Solar만 사용)")
